<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.two.crm.model.dao.Goods_DaoImpl">


<!--재고 전체조회-->
<select id="AllGoods"  resultType="gDto">
SELECT DISTINCT ig.G_NAME,
	CASE WHEN ig.G_CODE = FIRST_VALUE(ig.G_CODE) OVER() THEN '0.3% 할인' ELSE '할인 미적용' END AS DCODE_GOODS,IV_CNT,
	 ig.G_KG, ig.G_COUNTRY, ig.G_CONTENT,  ig.G_AMOUNT
	FROM CONTRACT c 
	JOIN CONTRACT_GOODS cg
	ON c.CT_CODE = cg.CT_CODE 
	JOIN INVENTORY_GOODS ig 
	ON cg.G_CODE = ig.G_CODE
	JOIN GOODS_DISCOUNT gd 
	ON ig.DCODE_GOODS = gd.DCODE_GOODS 
			<![CDATA[WHERE CT_START < SYSDATE
			AND CT_END > SYSDATE]]>
		ORDER BY IV_CNT
</select>


</mapper>
